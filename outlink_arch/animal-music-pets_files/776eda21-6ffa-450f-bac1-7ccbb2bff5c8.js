(()=>{let e;let t="PubxFloorProvider",o="pbxai_z";(e_=et||(et={})).WIN="WIN",e_.FLOORED="FLOORED",e_.NOBIDS="NOBIDS",(ep=eo||(eo={})).ERROR="ERROR",ep.WARNING="WARNING",(eg=ei||(ei={})).TIMEOUT="timeout",eg.ERROR="error",eg.SUCCESS="success";let i=()=>(()=>({splitRate:90,samplingRate:31,enableInstrumentationLogs:false,pbNsKeys:"pbjs",pbNamespace:null,currency:"USD",modelVersion:"cb_AB_z_dt_0.75_dwt_1.0_dnt_0.1",auctionDelay:200,pubxId:"776eda21-6ffa-450f-bac1-7ccbb2bff5c8",schema:['gptSlot','mediaType'],defaultValues:{'*|*':0.5807,'*|banner':0.5807,'/10518929/Science_LiveScience/news/article/mpu1|banner':0.6144,'/10518929/Science_LiveScience/news/article/mpu2|banner':0.64,'/10518929/Science_LiveScience/news/article/mpu3|banner':0.5962,'/10518929/Science_LiveScience/news/article/anchored|banner':0.5719,'/10518929/Science_LiveScience/reference/article/mpu1|banner':0.612,'/10518929/Science_LiveScience/reference/article/mpu2|banner':0.6,'/10518929/Science_LiveScience/news/article/incr-mpu-0|banner':0.609,'/10518929/Science_LiveScience/news/article/incr-mpu-1|banner':0.608,'/10518929/Science_LiveScience/news/article/incr-mpu-2|banner':0.6051,'/10518929/Science_LiveScience/news/article/incr-mpu-3|banner':0.608,'/10518929/Science_LiveScience/news/article/incr-mpu-4|banner':0.6122,'/10518929/Science_LiveScience/reference/article/anchored|banner':0.592,'/10518929/Science_LiveScience/news/article/incr-dbl-mpu-0|banner':0.568,'/10518929/Science_LiveScience/news/article/incr-rail-mpu-0|banner':0.5837,'/10518929/Science_LiveScience/news/article/incr-rail-mpu-1|banner':0.5855,'/10518929/Science_LiveScience/news/article/top-leaderboard|banner':0.5688,'/10518929/Science_LiveScience/news/article/anchored-leaderboard|banner':0.584,'/10518929/Science_LiveScience/reference/article/top-leaderboard|banner':0.568,'/10518929/Science_LiveScience/news/article/incr-mobile-leaderboard-0|banner':0.56,'/10518929/Science_LiveScience/reference/article/anchored-leaderboard|banner':0.5843},floorFetchUrl:"https://floor.pbxai.com/?pubxId=776eda21-6ffa-450f-bac1-7ccbb2bff5c8&page="+window.location.href,floorMin:0.05,floorEnforcement:{"floorDeals":true},hbPbKey:"hb_pb",pubxSplitKey:"pubx-a",pubxSplitOnValue:"on",pubxSplitTimeoutValue:"dfu",pubxSplitOffValue:"off",pubxTimeoutKey:"pubx-tm",pubxTimeoutOptimizedValue:"on",pubxTimeoutUnoptimizedValue:"off",pubxOptimizedKey:"pubx-op",pubxOptimizedOnValue:"on",pubxOptimizedOffValue:"off",pubxABSplitAKey:"pubx-exp-A",pubxABSplitBKey:"pubx-exp-B",pubxMvKey:"pubx-m_v",pubxFloorKey:"pubx-floor",pubxFloorMvKey:"pubx-floor-mv",pubxExperiments:{},isTimeoutSegregated:false}))(),r=(e,t)=>{window[t]=window[t]||{},window[t].que=window[t].que||[],window[t].name=t,e.pbNamespace=window[t]},a=e=>({provider:"pubxai",options:{samplingRate:e.samplingRate,pubxId:e.pubxId}}),n=e=>{e.pbNamespace.que.push(function(){let{debug:t,error:o,remotePageError:i}=window.__pubx__.logger;if(!e.pbNamespace.installedModules.includes("pubxaiAnalyticsAdapter")){i({code:en.PUBX_AA_NOT_FOUND});return}{let o=a(e);e.pbNamespace.enableAnalytics(o),t("Enabling Analytics",o)}})},d=e=>{let i={floorProvider:t,modelVersion:e.modelVersion,currency:e.currency,schema:{fields:e.schema},values:e.defaultValues||{"*|banner":.01}};return e.isTimeoutSegregated&&(i.skipRate=100,i.floorProvider=o),i},s=e=>{var t;let o={floors:{auctionDelay:e.auctionDelay,endpoint:{url:e.floorFetchUrl},data:d(e)}};return e.floorMin&&(o.floors.floorMin=e.floorMin),e.floorEnforcement&&(o.floors.enforcement=e.floorEnforcement),F(e.pubxExperiments)&&(null===(t=window.__pubx__.abTestConfig)||void 0===t?void 0:t.isABTestEnabled)&&(o=D(o)),o.floors.additionalSchemaFields={bidder:th,rank:tv},o},l=(e,i)=>{window.__pubxLoaded__&&e.pbNamespace.que.push(function(){let{debug:r,error:a,remotePageError:n}=window.__pubx__.logger;if(!e.pbNamespace.installedModules.includes("priceFloors")){n({code:en.PRICE_FLOORS_NOT_FOUND});return}let d=e.pbNamespace.getConfig("floors"),s=[t,"pbxai",o];d&&d.data&&d.data.floorProvider&&!s.includes(d.data.floorProvider)&&n({code:en.NON_PUBX_FLOORS_FOUND,payload:{existingFloors:d}});let l=i(e);l.floors.data&&l.floors.floorMin&&(r("Applying Floors Min",l.floors.floorMin),Object.keys(l.floors.data.values).forEach(e=>{let t=l.floors.data.values[e];void 0!==t&&void 0!==l.floors.floorMin&&(l.floors.data.values[e]=Math.max(t,l.floors.floorMin))})),window.__pubxFloorsConfig__=l,e.pbNamespace.setConfig(l),r("Setting Floors Config",l)})},u=(e,t)=>{let o=void 0!==e.adserverTargeting&&void 0!==e.adserverTargeting[t]&&!isNaN(e.adserverTargeting[t])&&parseFloat(e.adserverTargeting[t])>0;return o},c=(e,t)=>e.filter(e=>e.adUnitCode===t),_=(e,t)=>e.filter(e=>e.adUnitCode===t),p=(e,t)=>e.flatMap(e=>e.bids).filter(e=>e.adUnitCode===t),g=(e,t,o)=>0===e.length&&0===t.length?et.NOBIDS:e.some(e=>u(e,o))?et.WIN:et.FLOORED,f=(e,t,o,i,r,a)=>{try{if(void 0===e||"string"!=typeof t||"string"!=typeof o)throw Error(en.CURRENCY_INVALID_INPUT);if(void 0===i.pbNamespace.convertCurrency)throw Error(en.CURRENCY_MODULE_NOT_INSTALLED);if(t===o)return Number(e);return i.pbNamespace.convertCurrency(e,t,o)}catch(i){return a({code:en.CURRENCY_INVALID_INPUT,adUnitCode:r,payload:{error:i,value:e,fromCurrency:t,toCurrency:o}}),Number(e)}},b=(e,t)=>[...e,...t],m=e=>{if(void 0!==e)return{floorValue:e.floorValue,floorRule:e.floorRule,floorCurrency:e.floorCurrency}},O=(e,t,o,i,r,a,n)=>{var d;let{remoteAucError:s,remoteAucEvent:l}=n,{hbPbKey:c}=a,_,p,g,O,R={};switch(r){case et.WIN:let h=t.filter(e=>u(e,c)).sort((e,t)=>parseFloat(t.adserverTargeting[c])-parseFloat(e.adserverTargeting[c]))[0];_=parseFloat(h.adserverTargeting[c]),g=h.currency,O=h.floorData,R=h.adserverTargeting;break;case et.FLOORED:let v=b(o,t),E=v.sort((t,o)=>f(o.originalCpm,o.originalCurrency,a.currency,a,e.code,s)-f(t.originalCpm,t.originalCurrency,a.currency,a,e.code,s))[0];_=E.originalCpm,g=E.originalCurrency,O=E.floorData,R=E.adserverTargeting||{};break;case et.NOBIDS:let A;if(g=window.__pubxFloorsConfig__?window.__pubxFloorsConfig__.floors.data.currency:a.currency,td(e)){_=.01;break}let N=H(e.code);if(A=N?e3(N,window.__nextfloorsConfig__)||e3(N,window.__pubxFloorsConfig__):e4(e.code,window.__nextfloorsConfig__)||e4(e.code,window.__pubxFloorsConfig__)){_=A;break}window.__pubx__.logger.debug("NOBID floor rule not found for adUnit",e.code);let I=i.map(e=>{var t;if("function"!=typeof e.getFloor)return;let o=null===(t=e.getFloor({size:"*",mediaType:"banner"}))||void 0===t?void 0:t.floor;return"number"==typeof o&&o>=0?o:void 0}).filter(e=>void 0!==e);if(I.length>0){_=I.reduce((e,t)=>e+t,0)/I.length;break}window.__pubx__.logger.debug("NOBID getFloor() not found for adUnit",e.code),a.defaultValues&&void 0!==a.defaultValues["*|banner"]?_=a.defaultValues["*|banner"]:(window.__pubx__.logger.debug("NOBID TAG_DEFAULT_VALUES_NOT_FOUND for adUnit",e.code),_=.01)}return F(a.pubxExperiments)&&(null===(d=window.__pubx__.abTestConfig)||void 0===d?void 0:d.isABTestEnabled)&&Object.assign(R,tm(a)),l({type:"pbBid",data:{adUnitCode:e.code,status:r,bidCurrency:g,bidValue:parseFloat(_.toFixed(4)),pubCurrency:a.currency,floorData:m(O),adserverTargeting:R}}),p=_,r===et.FLOORED&&(_=f(_,g,a.currency,a,e.code,s)),{bidCpmValue:parseFloat(_.toFixed(4)),originalBidCpmValue:parseFloat(p.toFixed(4)),bidCurrency:g,floorData:m(O),adserverTargeting:R}},R=(e,t,o,i)=>{var r,a,n,d;let{adUnitBidsReceived:s,adUnitBidsRejected:l,adUnitBidsFromBidderRequests:u}=x(e,t),c=t.auctionId,_=g(s,l,o.hbPbKey),p=null===(a=null===(r=u[0])||void 0===r?void 0:r.floorData)||void 0===a?void 0:a.floorProvider,f=null===(d=null===(n=u[0])||void 0===n?void 0:n.floorData)||void 0===d?void 0:d.modelVersion,b=td(e),{bidCpmValue:m,originalBidCpmValue:R,bidCurrency:h,floorData:v,adserverTargeting:E}=O(e,s,l,u,_,o,i);return{auctionId:c,adUnit:e,adUnitStatus:_,bidCpmValue:m,originalBidCpmValue:R,bidCurrency:h,adserverTargeting:E,floorData:v,floorProvider:p,floorSkipStatus:b,floorModelVersion:f}},h=e=>e.adUnits.flatMap(e=>e.bids).map(ts).filter(e=>void 0!==e)[0],v=(e,t)=>{let o=e.bids.map(ts).filter(e=>void 0!==e)[0];if(void 0===o)throw t.remoteAucError({code:en.MODEL_VERSION_NOT_FOUND_READ,adUnitCode:e.code}),Error(ew[en.MODEL_VERSION_NOT_FOUND_READ].message+" for adUnit "+e.code);return o},E=e=>{let t=e.bids.map(e=>tl(e,window.__pubxLoaded__)).filter(e=>void 0!==e)[0];return t},A=e=>{let t=e.includes("_AB_")?e.split("_AB_")[1].split("_")[0]:void 0;return t},N=(e,t,o)=>{switch(o){case et.WIN:return e.includes("_dwt_")?parseFloat(e.split("_dwt_")[1].split("_")[0]):t.winBidMultiplier;case et.FLOORED:return e.includes("_dt_")?parseFloat(e.split("_dt_")[1].split("_")[0]):t.flooredBidMultiplier;case et.NOBIDS:return e.includes("_dnt_")?parseFloat(e.split("_dnt_")[1].split("_")[0]):t.noBidMultiplier}},I=(e,t,o)=>{if(e.includes("_fm_"))return parseFloat(e.split("_fm_")[1].split("_")[0]);if(!t.pmacFloorMultiplier)throw o({code:en.PMAC_FLOOR_MULTIPLIER_NOT_FOUND_CONFIG}),Error(ew[en.PMAC_FLOOR_MULTIPLIER_NOT_FOUND_CONFIG].message);return t.pmacFloorMultiplier},w=(e,t,o)=>{let i=void 0!==e.mediaTypes.banner,r=e.bids.some(e=>!!e.bidder),a=tu(e);if(!t&&a)throw o({code:en.PUBX_OFF_FLOORS_FOUND,adUnitCode:e.code}),Error(ew[en.PUBX_OFF_FLOORS_FOUND].message+" for adUnitCode "+e.code);return i&&r&&(!t&&!a||t&&a)},y=e=>e?e.filter(e=>!!e.originalCpm):[],T=(e,t,o,i)=>{let{remoteAucError:r}=i,{bidCpmValue:a,adUnitStatus:n,adUnit:d,auctionId:s}=e;ey({remoteError:r,code:en.UNCAUGHT_ERROR,location:"triggerPmac"},()=>{to(s,d.code,a,n,o,I(t,o,r),ez(t,o),i)}),d.code;let l=a*N(t,o,n);return o.floorMin&&(l=Math.max(l,o.floorMin)),l=parseFloat(l.toFixed(4)),td(d)?void 0:{adUnitCode:d.code,floorValue:l,status:n}},x=(e,t)=>{let o=t.auctionId,i=c(t.bidsReceived,e.code),r=_(y(t.bidsRejected),e.code),a=p(t.bidderRequests,e.code);return{auctionId:o,adUnitBidsReceived:i,adUnitBidsRejected:r,adUnitBidsFromBidderRequests:a}},C=e=>e.type===eo.ERROR&&e.arguments.length>0&&e.arguments[0].includes("Price Floors"),U=e=>{let t=e[0],o="";if(e.length>1)try{o=JSON.stringify(e[1])}catch(t){o=e[1]}window.__pubx__.logger.error("pubx: Price Floors Error",e),window.__pubx__.logger.remotePageError({code:en.FLOORS_RESPONSE_INVALID,payload:{error:t,message:o}})},S=e=>{e.pbNamespace.que.push(()=>{e.pbNamespace.onEvent("auctionInit",t=>{!function(e,t){var o,i,r,a;o=this,i=void 0,r=void 0,a=function*(){let{debug:o,error:i}=window.__pubx__.logger,r=100/e.samplingRate/100;if(100*Math.random()<r&&function(){let e=localStorage.getItem("lastCallDate"),t=new Date().toLocaleDateString();return e!==t}()){o("Telemetry Triggered");let r=function(e,t){let o=[],[i,r]=function(e){try{let t=e.adUnits||[],o=new Set,i=[];return t.forEach(function(e){let t;let r=Object.keys(e.mediaTypes||{});if(e.mediaTypes.banner){let o=e.mediaTypes.banner;t=o.sizes.map(e=>e.join("x"))}else t=[];let a=H(e.code),n=a?a.getAdUnitPath()===e.code?a.getSlotElementId():a.getSlotElementId()===e.code?a.getAdUnitPath():"":"";i.push({code:e.code,sizes:t,gamSlot:n,media_type:r}),e.bids.forEach(function(e){o.add(e.bidder)})}),[{adUnits:i,bidders:Array.from(o)},null]}catch(t){let e="Error in getAdUnitAndBidders, reason:"+t.message;return[{adUnits:[],bidders:[]},e]}}(t);null!==r&&o.push(r);let[a,n]=function(e){try{let t={PubxaiAA:!!e.pbNamespace.installedModules.includes("pubxaiAnalyticsAdapter"),PriceFloors:!!e.pbNamespace.installedModules.includes("priceFloors"),PubxaiRTD:!!e.pbNamespace.installedModules.includes("pubxaiRtdProvider")};return[t,null]}catch(t){let e="Error in getPubxModuleStatus, reason:"+t.message;return[{},e]}}(e);null!==n&&o.push(n);let d=eB();return{pubx_id:e.pubxId,pbjs_version:e.pbNamespace.version||"",installed_modules:e.pbNamespace.installedModules.filter(e=>!e.includes("BidAdapter"))||[],ad_units:i.adUnits,bidders:i.bidders,pubx_modules_status:a,errors:o.length>0?o:null,timestamp:new Date().toISOString(),page_info:ex(d)}}(e,t);try{let e=navigator.sendBeacon("https://analytics.pbxai.com/telemetry",new Blob([JSON.stringify(r)],{type:"application/json"}));e?(localStorage.setItem("lastCallDate",new Date().toLocaleDateString()),o("Telemetry data sent successfully using sendBeacon",r)):o("Telemetry API call failed using sendBeacon")}catch(e){i("Telemetry API call failed due to an error:",e)}}},new(r||(r=Promise))(function(e,t){function n(e){try{s(a.next(e))}catch(e){t(e)}}function d(e){try{s(a.throw(e))}catch(e){t(e)}}function s(t){var o;t.done?e(t.value):((o=t.value)instanceof r?o:new r(function(e){e(o)})).then(n,d)}s((a=a.apply(o,i||[])).next())})}(e,t=Object.assign({},t))});let t=e.pbNamespace.getEvents().filter(e=>"auctionDebug"===e.eventType).map(e=>e.args).filter(C);t.forEach(e=>U(e.arguments)),e.pbNamespace.onEvent("auctionDebug",e=>{C(e)&&U(e.arguments)})})},D=e=>{var t,o,i,r;if(!(null===(t=window.__pubx__.abTestConfig)||void 0===t?void 0:t.isABTestEnabled)||(null===(o=window.__pubx__.abTestConfig)||void 0===o?void 0:o.testBucket)!=="A"&&(null===(i=window.__pubx__.abTestConfig)||void 0===i?void 0:i.testBucket)!=="B")return e;let a=(null===(r=window.__pubx__.abTestConfig)||void 0===r?void 0:r.testBucket)==="A";return e.floors.enforcement?e.floors.enforcement.enforceJS=a:e.floors.enforcement={enforceJS:a},e},F=e=>!!e&&"number"==typeof(null==e?void 0:e.enforceJsSplit)&&e.enforceJsSplit>0,P=e=>!!e&&void 0!==(null==e?void 0:e.tmAbTest)&&e.tmAbTest,M=e=>!!e&&void 0!==(null==e?void 0:e.alwaysGenerateAuctionId)&&"true"===e.alwaysGenerateAuctionId,L=e=>{let o=e.pbNamespace.getConfig("floors");o&&o.data&&o.data.floorProvider&&o.data.floorProvider===t&&(!o.floorMin&&e.floorMin&&(o.floorMin=e.floorMin),!o.enforcement&&e.floorEnforcement&&(o.enforcement=e.floorEnforcement),window.__pubxFloorsConfig__={floors:o})},B=(e,t)=>{if(window.__pubxLoaded__)try{e.pbNamespace.que.push(function(){L(e),window.__pubx__.pubxDefaultsAvailable||l(e,t)})}catch(t){let{error:e}=window.__pubx__.logger;e("Error setting default floors config to local storage:",t)}},G=e=>{try{let t=window.localStorage.getItem("pubx:defaults");t&&(window.localStorage.removeItem("pubx:defaults"),window.__pubx__.logger.debug("Cleared local storage defaults"));let o=s(e),i={data:o.floors.data,expiry:new Date().getTime()+2592e5};window.localStorage.setItem("pubx:defaults",JSON.stringify(i)),window.__pubx__.logger.debug("Set local storage defaults")}catch(t){let{error:e}=window.__pubx__.logger;e("Error overwriting local storage defaults:",t)}},V=e=>{let{floorData:t}=e;if(t&&("timeout"===t.fetchStatus||"error"===t.fetchStatus))return t.fetchStatus},k=e=>{let t=e.bids.some(V),i=e.bids.some(e=>{var t;return(null===(t=null==e?void 0:e.floorData)||void 0===t?void 0:t.floorProvider)===o});return t||i},j=()=>(()=>({flooredBidMultiplier:0.75,noBidMultiplier:0.1,winBidMultiplier:1.0,pmacFloorMultiplier:0.5,decayRate:null,gamBuckets:[{'pbx_a0d_n':[0,0.03]},{'pbx_a1d_n':[0.03,0.06]},{'pbx_a2d_n':[0.06,0.09]},{'pbx_a3d_n':[0.09,0.12]},{'pbx_a4d_n':[0.12,0.15]},{'pbx_b0d_n':[0.15,0.2]},{'pbx_b1d_n':[0.2,0.25]},{'pbx_b2d_n':[0.25,0.3]},{'pbx_b3d_n':[0.3,0.35]},{'pbx_b4d_n':[0.35,0.4]},{'pbx_b5d_n':[0.4,0.45]},{'pbx_b6d_n':[0.45,0.5]},{'pbx_b7d_n':[0.5,0.55]},{'pbx_b8d_n':[0.55,0.6]},{'pbx_b9d_n':[0.6,0.65]},{'pbx_b10d_n':[0.65,0.7]},{'pbx_b11d_n':[0.7,0.75]},{'pbx_b12d_n':[0.75,0.8]},{'pbx_b13d_n':[0.8,0.85]},{'pbx_b14d_n':[0.85,0.9]},{'pbx_b15d_n':[0.9,0.95]},{'pbx_b16d_n':[0.95,1]},{'pbx_c0d_n':[1,1.1]},{'pbx_c1d_n':[1.1,1.2]},{'pbx_c2d_n':[1.2,1.3]},{'pbx_c3d_n':[1.3,1.4]},{'pbx_c4d_n':[1.4,1.5]},{'pbx_c5d_n':[1.5,1.6]},{'pbx_c6d_n':[1.6,1.7]},{'pbx_c7d_n':[1.7,1.8]},{'pbx_c8d_n':[1.8,1.9]},{'pbx_c9d_n':[1.9,2]},{'pbx_d0d_n':[2,2.25]},{'pbx_d1d_n':[2.25,2.5]},{'pbx_d2d_n':[2.5,2.75]},{'pbx_d3d_n':[2.75,3]},{'pbx_d4d_n':[3,3.25]},{'pbx_d5d_n':[3.25,3.5]},{'pbx_d6d_n':[3.5,3.75]},{'pbx_d7d_n':[3.75,4]},{'pbx_d8d_n':[4,4.25]},{'pbx_d9d_n':[4.25,4.5]},{'pbx_d10d_n':[4.5,4.75]},{'pbx_d11d_n':[4.75,5]},{'pbx_d12d_n':[5,111111]}]}))(),K=()=>{window.googletag=window.googletag||{},window.googletag.cmd=window.googletag.cmd||[]},W=e=>{let t=i();r(t,e);let o=j();return K(),Object.assign(Object.assign({},t),o)},X=(e,t)=>{let{error:o}=window.__pubx__.logger,i=googletag.pubads().getSlots(),r=[];return e.forEach(e=>{let t=i.find(t=>t.getAdUnitPath()===e||t.getSlotElementId()===e);void 0!==t&&r.push({adUnitCode:e,slot:t})}),r},q=(e,t,o,i,r,a,n="")=>{let{remoteAucEvent:d}=a;r.setTargeting(o,i),window.__pubx__.logger.debug("Setting KVs in GAM",n,{auctionId:e,adUnitCode:t,key:o,value:i,gptSlot:r}),d({type:"gamTargeting",data:{adUnitCode:t,[o]:i}})},H=e=>{if(!(null==googletag?void 0:googletag.pubads)||"function"!=typeof googletag.pubads)return;let t=googletag.pubads().getSlots().find(t=>t.getAdUnitPath()===e||t.getSlotElementId()===e);return t},Y=(e,t,o)=>{let i=H(t);if(i){let r=i.getTargetingKeys().filter(e=>[o.pubxSplitKey,o.pubxOptimizedKey,o.pubxMvKey,o.pubxFloorKey,o.pubxFloorMvKey].includes(e));r.forEach(e=>{i.clearTargeting(e)}),window.__pubx__.logger.debug("Clearing KVs in GAM",{auctionId:e,adUnitCode:t,keys:r})}},z=(e,t,o,i,r)=>{let{remoteAucError:a}=r;googletag.cmd.push(()=>{ey({remoteError:a,code:en.UNCAUGHT_GAM_ERROR,location:"setKeyGam"},()=>{let a=e.code;Y(t,a,i);let{remoteAucError:n}=r,{__pubxGamQue__:d}=window,s=H(a);s?Object.entries(o).forEach(([e,o])=>{q(t,a,e,o,s,r)}):d.push({id:eB(),auctionId:t,adUnitCode:a,cmd:()=>{let e=H(a);return e?(Object.entries(o).forEach(([o,i])=>{q(t,a,o,i,e,r,"from QUE")}),!0):(n({code:en.GAM_QUE_GPT_SLOT_NOT_FOUND,adUnitCode:a}),!1)},error:()=>{n({code:en.GPT_SLOT_NOT_FOUND,adUnitCode:a})},logged:!1})})})},J=(e,t,o)=>{e.pbNamespace.que.push(()=>{e.pbNamespace.onEvent("auctionEnd",i=>{try{i=Object.assign({},i);let{makeRemoteAucError:r,makeRemoteAucEvent:a,error:n}=window.__pubx__.logger,d=r(i),s=a(i),l={remoteAucError:d,remoteAucEvent:s};ey({remoteError:d,code:en.UNCAUGHT_ERROR,location:"readAndSetKvsAuction"},()=>{let{variant:r}=window.__pubx__,a=["PB_GAM_CUSTOM_MG","PB_GAM_CUSTOM_RELEVANT_MEDIA"].includes(r),n=["PB_GAM_CUSTOM_MG","PB_GAM_CUSTOM_MG_STATIC"].includes(r);window.__pubx__.logger.debug("pubx: setPubxLoadedFromAuctionData",a),a&&(window.__pubxLoaded__=i.adUnits.some(tu),window.__pubx__.logger.debug("pubx: window.__pubxLoaded__",window.__pubxLoaded__));let s=window.__pubxLoaded__;o&&(i=o(i,e,l)),i.adUnits.filter(e=>w(e,s,l.remoteAucError)).map(o=>{ey({remoteError:d,code:en.UNCAUGHT_ERROR,location:"readAndSetKvsAdUnit"},()=>{var r;let a=tb(o,e,l);F(e.pubxExperiments)&&(null===(r=window.__pubx__.abTestConfig)||void 0===r?void 0:r.isABTestEnabled)&&Object.assign(a,tm(e)),P(e.pubxExperiments)&&Object.assign(a,tO(e,a));let d=R(o,i,e,l);if(tu(o)){if(n){let t={vendor:"pubxai",auctionId:i.auctionId,transactionId:o.transactionId||eB(),billingId:eB(),type:"impression"};e.pbNamespace.rp.billableEvent(t),window.__pubx__.logger.debug("pubx: billable event raised for adUnit:",o.code,t)}let t=v(o,l);Object.assign(a,tc(t,e));let r=T(d,t,e,l);r&&Object.assign(a,t_(r,t,e,l.remoteAucError))}t&&t(o,i.auctionId,a,e,l)})})})}catch(e){window.__pubx__.logger.error(e)}})})},$=(e,t)=>{if(0===e)return t[0];let o=t.find(t=>{let o=Object.keys(t)[0],[i,r]=t[o];return e>i&&e<=r});return o},Q=(e,t,o)=>{let i=$(e.floorValue,t.gamBuckets);if(void 0===i)throw o({code:en.GAM_BUCKET_NOT_FOUND,adUnitCode:e.adUnitCode,payload:{floorWithStatus:e}}),Error(ew[en.GAM_BUCKET_NOT_FOUND].message+" for "+JSON.stringify(e));let r=Object.keys(i)[0],a=e.status===et.WIN?"_w":e.status===et.FLOORED?"_f":"_n";return r.split("_n")[0]+a},Z=e=>{e.pbNamespace.que.push(function(){let{error:e,remotePageError:t}=window.__pubx__.logger;googletag.cmd.push(()=>{googletag.pubads().addEventListener("slotAdded",e=>{ey({remoteError:t,code:en.UNCAUGHT_GAM_ERROR,location:"setupEventHandlersForGamQue"},()=>{let t=e.slot,{__pubxGamQue__:o}=window,i=o.filter(e=>t&&(t.getAdUnitPath()===e.adUnitCode||t.getSlotElementId()===e.adUnitCode));i.forEach(e=>{if(e.cmd()){let t=o.findIndex(t=>t.id===e.id);t>-1&&o.splice(t,1)}})})})})})};(ef=er||(er={})).DBM_HEURISTICS="dbm_heuristics",ef.PMAC_DATA="pmac_data";let ee=()=>{try{let e=[localStorage,sessionStorage];e.forEach(e=>{e.removeItem("pbx:dpbid"),e.removeItem("pubx:pmac"),e.removeItem("pubx:extraData")})}catch(e){console.error(e)}};var et,eo,ei,er,ea,en,ed,es,el,eu,ec,e_,ep,eg,ef,eb,em,eO,eR,eh,ev,eE,eA=function(e,t,o,i){return new(o||(o=Promise))(function(r,a){function n(e){try{s(i.next(e))}catch(e){a(e)}}function d(e){try{s(i.throw(e))}catch(e){a(e)}}function s(e){var t;e.done?r(e.value):((t=e.value)instanceof o?t:new o(function(e){e(t)})).then(n,d)}s((i=i.apply(e,t||[])).next())})},eN=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,i=Object.getOwnPropertySymbols(e);r<i.length;r++)0>t.indexOf(i[r])&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(o[i[r]]=e[i[r]]);return o};(eb=ea||(ea={})).IN_PROGRESS="IN_PROGRESS",eb.SUCCESS="SUCCESS",eb.ERROR="ERROR",(em=en||(en={})).GPT_SLOT_NOT_FOUND="GPT_SLOT_NOT_FOUND",em.GAM_QUE_GPT_SLOT_NOT_FOUND="GAM_QUE_GPT_SLOT_NOT_FOUND",em.GAM_BUCKET_NOT_FOUND="GAM_BUCKET_NOT_FOUND",em.CALC_FLOOR_NOT_FOUND="CALC_FLOOR_NOT_FOUND",em.IMPROVEMEDIA_API_NOT_FOUND="IMPROVEMEDIA_API_NOT_FOUND",em.INVESTING_FILTER_NOT_FOUND="INVESTING_FILTER_NOT_FOUND",em.PUBX_AA_NOT_FOUND="PUBX_AA_NOT_FOUND",em.PRICE_FLOORS_NOT_FOUND="PRICE_FLOORS_NOT_FOUND",em.NON_PUBX_FLOORS_FOUND="NON_PUBX_FLOORS_FOUND",em.CURRENCY_INVALID_INPUT="CURRENCY_INVALID_INPUT",em.CURRENCY_MODULE_NOT_INSTALLED="CURRENCY_MODULE_NOT_INSTALLED",em.GET_FLOOR_NOT_FOUND="GET_FLOOR_NOT_FOUND",em.NO_BID_FLOOR_RULE_NOT_FOUND="NO_BID_FLOOR_RULE_NOT_FOUND",em.TAG_DEFAULT_VALUES_NOT_FOUND="TAG_DEFAULT_VALUES_NOT_FOUND",em.PUBX_OFF_FLOORS_FOUND="PUBX_OFF_FLOORS_FOUND",em.MODEL_VERSION_NOT_FOUND_READ="MODEL_VERSION_NOT_FOUND_READ",em.PMAC_FLOOR_MULTIPLIER_NOT_FOUND_CONFIG="PMAC_FLOOR_MULTIPLIER_NOT_FOUND_CONFIG",em.INVALID_SCHEMA_FIELDS_FLOORS_RESPONSE="INVALID_SCHEMA_FIELDS_FLOORS_RESPONSE",em.MISSING_ADUNIT_FLOOR_RESPONSE="MISSING_ADUNIT_FLOOR_RESPONSE",em.PMAC_FLOOR_RESPONSE_NOT_AVAILABLE="PMAC_FLOOR_RESPONSE_NOT_AVAILABLE",em.UNCAUGHT_ERROR="UNCAUGHT_ERROR",em.UNCAUGHT_GAM_ERROR="UNCAUGHT_GAM_ERROR",em.PUBX_ANALYTICS_ERROR="PUBX_ANALYTICS_ERROR",em.FLOORS_RESPONSE_INVALID="FLOORS_RESPONSE_INVALID",(eO=ed||(ed={})).INFO="INFO",eO.WARNING="WARNING",eO.ERROR="ERROR",eO.FATAL="FATAL";let eI={a:[0,1],b:[2,6],c:[7,11],d:[12,16],e:[17,Number.MAX_SAFE_INTEGER]},ew={[en.GPT_SLOT_NOT_FOUND]:{message:"GPT Slot not found",severity:ed.WARNING},[en.GAM_QUE_GPT_SLOT_NOT_FOUND]:{message:"Gam Que: GPT Slot not found",severity:ed.ERROR},[en.GAM_BUCKET_NOT_FOUND]:{message:"GAM Bucket not found",severity:ed.WARNING},[en.CALC_FLOOR_NOT_FOUND]:{message:"floorWithStatus not found",severity:ed.FATAL},[en.IMPROVEMEDIA_API_NOT_FOUND]:{message:"lwhbim.adServerKeywordsAdUnit is not defined",severity:ed.ERROR},[en.INVESTING_FILTER_NOT_FOUND]:{message:"window._imhb_auctions is not defined",severity:ed.ERROR},[en.PUBX_AA_NOT_FOUND]:{message:"pubxaiAnalyticsAdapter module is not installed",severity:ed.WARNING},[en.PRICE_FLOORS_NOT_FOUND]:{message:"priceFloors module is not installed",severity:ed.WARNING},[en.NON_PUBX_FLOORS_FOUND]:{message:"Non-pubx floor provider present",severity:ed.WARNING},[en.CURRENCY_INVALID_INPUT]:{message:"Invalid input types for currency conversion",severity:ed.WARNING},[en.CURRENCY_MODULE_NOT_INSTALLED]:{message:"currency module of prebid.js is not installed",severity:ed.WARNING},[en.GET_FLOOR_NOT_FOUND]:{message:"calc nbids - None of bidderRequests.bids.getFloor() is defined",severity:ed.WARNING},[en.NO_BID_FLOOR_RULE_NOT_FOUND]:{message:"calc nbids - Floor rule not found in __pubxFloorsConfig__ and __nextfloorsConfig__",severity:ed.WARNING},[en.TAG_DEFAULT_VALUES_NOT_FOUND]:{message:"defaultValues of *|banner in config is undefined",severity:ed.ERROR},[en.PUBX_OFF_FLOORS_FOUND]:{message:"pubxLoaded is false but has floorData",severity:ed.FATAL},[en.MODEL_VERSION_NOT_FOUND_READ]:{message:"floorModelVersion is undefined but adUnit.bids is not",severity:ed.FATAL},[en.PMAC_FLOOR_MULTIPLIER_NOT_FOUND_CONFIG]:{message:"PMAC floor multiplier not found in config",severity:ed.ERROR},[en.INVALID_SCHEMA_FIELDS_FLOORS_RESPONSE]:{message:"Invalid schema fields in floor rules response, expected only ['gptSlot']",severity:ed.ERROR},[en.MISSING_ADUNIT_FLOOR_RESPONSE]:{message:"adUnitCode not found in floor rules response",severity:ed.ERROR},[en.PMAC_FLOOR_RESPONSE_NOT_AVAILABLE]:{message:"Floors Reponse not available for pmac",severity:ed.WARNING},[en.UNCAUGHT_ERROR]:{message:"Uncaught Error",severity:ed.ERROR},[en.UNCAUGHT_GAM_ERROR]:{message:"Uncaught GAM Error",severity:ed.ERROR},[en.PUBX_ANALYTICS_ERROR]:{message:"Pubx Analytics Error",severity:ed.ERROR},[en.FLOORS_RESPONSE_INVALID]:{message:"Floors Response Invalid",severity:ed.ERROR}},ey=({remoteError:e,code:t,location:o},i)=>{try{i()}catch(i){window.__pubx__.logger.error(i),e({code:t,payload:{name:i.name,message:i.message,location:o}})}},eT=e=>{let{__pubx__:{variant:t,version:o}}=window;return{variant:t,version:o,loadTime:window.__loadTime__,pbVersion:e.pbNamespace.version,pbNamespace:e.pbNamespace.name}},ex=e=>({userAgent:navigator.userAgent,host:window.location.host,path:window.location.pathname,pageId:e,doNotTrack:navigator.doNotTrack}),eC=(e,t)=>e.pbNamespace.getEvents().filter(e=>"auctionEnd"===e.eventType).findIndex(e=>e.args.auctionId===t),eU=e=>e.pbNamespace.getEvents().filter(e=>"auctionInit"===e.eventType).length,eS=e=>{let{code:t,adUnitCode:o,payload:i}=e,{message:r,severity:a}=ew[t];return{code:t,severity:a,message:r,adUnitCode:o,payload:i}},eD=(e,t,o,i)=>{let r=t;if(e.adUnitCode){let{adUnits:t,bidderRequests:o,bidsReceived:i,bidsRejected:a}=r;r=Object.assign(Object.assign({},r),{adUnits:t.filter(t=>t.code===e.adUnitCode),bidderRequests:o.map(t=>Object.assign(Object.assign({},t),{bids:t.bids.filter(t=>t.adUnitCode===e.adUnitCode)})),bidsReceived:i.filter(t=>t.adUnitCode===e.adUnitCode),bidsRejected:a?a.filter(t=>t.adUnitCode===e.adUnitCode):void 0})}let{auctionId:a,adUnits:n,bidderRequests:d,bidsReceived:s,bidsRejected:l}=r,u={adUnits:n.map(({code:e,sizes:t,bids:o,mediaTypes:i})=>({code:e,mediaTypes:Object.keys(i)})),bidderRequestsCount:d.length,bidsReceived:s.map(({adUnitCode:e,adserverTargeting:t,cpm:o,currency:i,originalCpm:r,originalCurrency:a,floorData:n})=>({adUnitCode:e,adserverTargeting:t?{hb_pb:t.hb_pb}:void 0,cpm:o,currency:i,originalCpm:r,originalCurrency:a,floorData:n?{floorValue:n.floorValue}:void 0})),bidsRejected:l?l.map(({adUnitCode:e,adserverTargeting:t,cpm:o,currency:i,originalCpm:r,originalCurrency:a,floorData:n})=>({adUnitCode:e,adserverTargeting:t?{hb_pb:t.hb_pb}:void 0,cpm:o,currency:i,originalCpm:r,originalCurrency:a,floorData:n?{floorValue:n.floorValue}:void 0})):void 0};return Object.assign({previousAuctionCount:eC(o,a),auctionId:a,auctionInfo:u,modelVersion:h(t)},eF(e,o,i))},eF=(e,t,o)=>({type:"error",isPubxEnabled:window.__pubxLoaded__,pubxId:t.pubxId,tagInfo:eT(t),pageInfo:ex(o),errorData:eS(e),timesince:Date.now()-window.__loadTimestamp__,timestamp:Date.now()}),eP=e=>{let t=e.pbNamespace.getConfig("floors");return t&&t.data&&t.data.floorProvider?t.data.floorProvider:void 0},eM=(e,t,o,i)=>{let{auctionId:r,adUnits:a,bidsReceived:n,bidsRejected:d,bidderRequests:s}=e,l={adUnitCount:a.length,bidCount:n.length+(d?d.length:0),bidders:[...new Set(s.map(({bidderCode:e})=>e))]};return{type:"event",isPubxEnabled:window.__pubxLoaded__,pubxId:t.pubxId,loadedBeforePb:window.__loadedBeforePb__,tagInfo:eT(t),floorProvider:eP(t),pageInfo:ex(i),missedAuctionCount:o,timesince:Date.now()-window.__loadTimestamp__,timestamp:Date.now(),previousAuctionCount:eC(t,r),auctionId:r,auctionInfo:l,modelVersion:h(e),pbBidData:[],gamTargetingData:[]}},eL=e=>{let{severity:t}=ew[e.code];return!1},eB=()=>{let e=new Date().getTime(),t="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(o){let i=16*Math.random();return e>0?(i=(e+i)%16|0,e=Math.floor(e/16)):(i=(t+i)%16|0,t=Math.floor(t/16)),("x"===o?i:3&i|8).toString(16)})},eG=e=>/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e),eV=()=>{window.__pubxGamQue__.filter(e=>!e.logged).forEach(e=>{e.error(),e.logged=!0})},ek=e=>{let t=[],o=[],i=[],r=eU(e),a=eB(),n=e.enableInstrumentationLogs&&1/e.samplingRate>Math.random();window.__pubxLogsEnabled__=n;let d=e=>JSON.stringify(e).length,s=(e,t)=>{let o=[],i=0,r=[];for(let a of e){let e=d([a]);i+e>t?(r.push(o),o=[a],i=e):(o.push(a),i+=e)}return o.length>0&&r.push(o),r},l=(e,t)=>{0!==e.length&&s(e,65536).map(e=>{JSON.parse(JSON.stringify(e));let o=new Blob([JSON.stringify(e)],{type:"application/json"});navigator.sendBeacon(t,o)})},u=()=>!!navigator.sendBeacon&&!!document.visibilityState;u()&&document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&(eV(),l([...t,...o,...i],"https://analytics.pbxai.com/logs"),[t,o,i].map(e=>e.splice(0)))});let c=window.location.search,_=new URLSearchParams(c),p=(...e)=>{e=e.filter(e=>void 0!==e),_.has("pubx_debug")&&console.error("%cPubx.ai","background-color: #fc6203; color: white; border-radius: 3px; padding: 1px 4px","ERROR:",...e)};return{debug:(e,...t)=>{_.has("pubx_debug")&&console.info("%cPubx.ai","background-color: #fc6203; color: white; border-radius: 3px; padding: 1px 4px","INFO:",e,...t)},error:p,makeRemoteAucError:o=>i=>{let{code:r,adUnitCode:d,payload:s}=i;p(ew[r].message,d,s),u()&&(n||eL(i))&&t.push(eD(i,o,e,a))},remotePageError:t=>{let{code:i,adUnitCode:r,payload:d}=t;p(ew[i].message,r,d),u()&&(n||eL(t))&&o.push(eF(t,e,a))},makeRemoteAucEvent:t=>{let o=(o,i)=>{let n=i.find(e=>e.auctionId===t.auctionId);if(void 0===n&&(n=eM(t,e,r,a),i.push(n)),"pbBid"===o.type)n.pbBidData.push(o.data);else if("gamTargeting"===o.type){let e=o.data,t=n.gamTargetingData.find(t=>t.adUnitCode===e.adUnitCode);void 0===t?n.gamTargetingData.push(e):Object.assign(t,e)}};return e=>{u()&&n&&o(e,i)}}}},ej=e=>{window.__pubx__.logger.debug("version:",window.__pubx__.variant+"_"+window.__pubx__.version+"_"+e.name)},eK=()=>{window.__loadTime__=window.__loadTimestamp__?Date.now()-window.__loadTimestamp__:-1,window.__loadTimestamp__=Date.now()},eW=(e,t)=>{let o=window.__pubxFloorsConfig__.floors,{auctionDelay:i,endpoint:r,data:a}=o,n=eN(o,["auctionDelay","endpoint","data"]);window.__nextfloorsConfig__={floors:Object.assign(Object.assign({},n),{data:e})}},eX=(e,t)=>{let o=t.pbNamespace.getConfig("floors"),{auctionDelay:i,endpoint:r,data:a}=o,n=eN(o,["auctionDelay","endpoint","data"]);window.__nextfloorsConfig__={floors:Object.assign(Object.assign({},n),{data:e})}},eq=e=>window.__pmacCpmHistory__[e],eH=e=>{let t=eq(e);return t?t.history:[]},eY=(e,t,o,i)=>{let{debug:r}=window.__pubx__.logger,{__pmacCpmHistory__:a}=window;void 0===a[t]&&(a[t]={history:[],decayRate:void 0});let n={auctionId:e,cpm:o,adUnitStatus:i};eH(t).push(n),r("Update Pmac history",t,n)},ez=(e,t)=>{let{debug:o}=window.__pubx__.logger;return e.includes("_dr_")?-1*parseFloat(e.split("_dr_")[1].split("_")[0]):null!==t.decayRate?-1*t.decayRate:(o("No decay rate in floor model version or config",e),null)},eJ=(e,t,o)=>(e=0===e?.01:e)*Math.exp(t*o),e$=(e,t)=>{let{debug:o}=window.__pubx__.logger,i=eq(e);i.decayRate=t,o("Assigning decay rate",e,i.decayRate)},eQ=e=>{let t=eH(e);return 0!==t.length},eZ=(e,t,o=null)=>{let{remoteAucError:i}=t,{__pmacCpmHistory__:r}=window,a=Object.keys(r);if("PB_GAM_CUSTOM_AY"===window.__pubx__.variant)a.forEach(i=>{eQ(i)&&e6(i,void 0,e5(i,e,o),t)});else{let r=X(a,i);r.forEach(({adUnitCode:i,slot:r})=>{eQ(i)&&e6(i,r,e5(i,e,o),t)})}},e0=e=>"|banner"+(e.fields.includes("size")?"|*":""),e1=(e,t,o)=>{let i=Object.keys(t),r=e0(o),a=i.find(t=>[e.getAdUnitPath()+r,e.getSlotElementId()+r].includes(t));return a},e2=(e,t,o)=>{let i=Object.keys(t),r=i.find(t=>t.split(e0(o))[0]===e);return r},e9=(e,t,o)=>{let i=Object.keys(t),r=i.find(t=>t.split(e0(o))[0]===tR(e));return r},e4=(e,t)=>{if(t){let o=e2(e,t.floors.data.values,t.floors.data.schema);if(o)return t.floors.data.values[o]}},e3=(e,t)=>{if(t){let o=e1(e,t.floors.data.values,t.floors.data.schema);if(o)return t.floors.data.values[o]}},e6=(e,t,o,i)=>{let r;let{remoteAucError:a}=i,{__nextfloorsConfig__:n}=window;if(void 0===n)throw Error("__nextfloorsConfig__ undefined. Skip updating adUnit floors config");let{floors:{data:{values:d,schema:s}}}=n;if(void 0===(r="PB_GAM_CUSTOM_AY"===window.__pubx__.variant?e9(e,d,s):e1(t,d,s))){a({code:en.MISSING_ADUNIT_FLOOR_RESPONSE,adUnitCode:e});return}d[r]=o},e5=(e,t,o=null)=>{let{decayRate:i,history:r}=eq(e),[a,n]=[r[0].cpm,r.length],d=eJ(a,i,n),s=d*t;return null!==o&&(s=Math.max(s,o)),s<.01?.01:parseFloat(s.toFixed(4))},e7=(e,t)=>eA(void 0,void 0,void 0,function*(){let{debug:t}=window.__pubx__.logger;try{let o=yield fetch(e.floorFetchUrl),i=yield o.json();t("PMAC Received floor rules",i),eW(i,e)}catch(i){let o=d(e);t("PMAC Default floor rules",o),eW(o,e)}}),e8=(e,t)=>eA(void 0,void 0,void 0,function*(){let{debug:t}=window.__pubx__.logger;try{let o=yield fetch(e.floorFetchUrl),i=yield o.json();t("PMAC Received floor rules",i),eX(i,e)}catch(i){let o=d(e);t("PMAC Default floor rules",o),eX(o,e)}}),te=(e,t)=>eA(void 0,void 0,void 0,function*(){let{debug:t}=window.__pubx__.logger,o=e.pbNamespace.getConfig("floors");window.__nextfloorsConfig__={floors:o},t("Reading floors from config",o)}),tt=()=>eA(void 0,void 0,void 0,function*(){let e=()=>{let{debug:e}=window.__pubx__.logger,t=window.__pubxFloorsConfig__;if(!t)throw Error("__pubxFloorsConfig__ not defined. Skip pmac");window.__nextfloorsConfig__=t,e("Reading floors from rtd module",t)};e(),window.addEventListener("floorsApi",t=>{t.detail.status===ea.SUCCESS&&e()})}),to=(e=null,(t,o,i,r,a,n,d,s)=>eA(void 0,void 0,void 0,function*(){let{remoteAucError:u}=s,{variant:c,isRtd:_}=window.__pubx__;if(null===d){window.__pubx__.logger.debug("pubx: PMAC Turned off");return}null===e&&(e=_?tt():"PB_GAM_CUSTOM_AZ"===c?te(a,s):"PB_GAM_CUSTOM_MG"==c||c.includes("STATIC")?e8(a,s):e7(a,s)),yield e,window.__pubx__.logger.debug("pubx:","triggering pmac"),eY(t,o,i,r),e$(o,d);let{__nextfloorsConfig__:p}=window;if(void 0===p)throw u({code:en.PMAC_FLOOR_RESPONSE_NOT_AVAILABLE,adUnitCode:o}),Error("__nextfloorsConfig__ undefined. Skip updating floors config");"PB_GAM_CUSTOM_AY"===c?(eZ(n,s,a.floorMin),l(a,e=>p)):googletag.cmd.push(()=>{ey({remoteError:u,code:en.UNCAUGHT_GAM_ERROR,location:"updateSetFloor"},()=>{eZ(n,s,a.floorMin),l(a,e=>p)})})})),ti=()=>({debug:(e,...t)=>{},error:(...e)=>{},makeRemoteAucError:e=>e=>{},remotePageError:e=>{},makeRemoteAucEvent:e=>e=>{}}),tr=(e,t)=>{ee(),window.__pubxFloors__={},!1!==window.__loadedBeforePb__&&(window.__loadedBeforePb__=void 0===e.pbNamespace.version),window.__pmacCpmHistory__={},eK(),window.__pubx__=Object.assign(Object.assign({},window.__pubx__),{variant:t,version:"1754555892778",isRtd:!1}),window.__pubx__.logger||(window.__pubx__.logger=ti()),window.__pubxLoaded__&&F(e.pubxExperiments)&&tE(e.pubxExperiments.enforceJsSplit)&&(window.__pubx__.abTestConfig={isABTestEnabled:!0,testBucket:50>100*Math.random()?"A":"B"}),e.pbNamespace.que.push(function(){window.__pubx__.logger=ek(e),ej(e.pbNamespace)}),window.__pubxGamQue__=[]},ta=(e,t)=>{window.__pubxLoaded__=tn(e.splitRate),tr(e,t)},tn=e=>(void 0===window.__pubxLoaded__&&(window.__pubxLoaded__=e>100*Math.random()),window.__pubxLoaded__),td=e=>e.bids.some(({floorData:e})=>e&&e.floorProvider===t&&e.skipped),ts=e=>{let{floorData:o}=e;if(o&&o.floorProvider===t&&o.modelVersion)return o.modelVersion},tl=(e,o)=>{let{floorData:i}=e;if(i&&(i.floorProvider===t||!o))return i.fetchStatus},tu=e=>{let t=e.bids.some(ts),o=e.bids.some(e=>{var t,o;return(null===(t=null==e?void 0:e.floorData)||void 0===t?void 0:t.skipRate)!==void 0&&(null===(o=null==e?void 0:e.floorData)||void 0===o?void 0:o.skipRate)<100});return t&&o},tc=(e,t)=>{let o={},i=A(e);return i&&(o[t.pubxMvKey]=i),o},t_=(e,t,o,i)=>{let r={},a=Q(e,o,i);r[o.pubxFloorKey]=a;let n=A(t);if(n){let e=tp(a,n);r[o.pubxFloorMvKey]=e}return r},tp=(e,t)=>e+"-"+t,tg=(e,t)=>{let o=td(e);return o?t.pubxOptimizedOffValue:t.pubxOptimizedOnValue},tf=(e,t)=>{let o=tu(e),i=t.isTimeoutSegregated&&k(e);return i?t.pubxSplitTimeoutValue:o?t.pubxSplitOnValue:t.pubxSplitOffValue},tb=(e,t,o)=>{let i={},r=tf(e,t);i[t.pubxSplitKey]=r;let a=E(e),n=r===t.pubxSplitOffValue,d=a===ei.TIMEOUT;if(d&&(i[t.pubxTimeoutKey]=n?t.pubxTimeoutUnoptimizedValue:t.pubxTimeoutOptimizedValue),n)return i;let s=v(e,o),l=t.modelVersion===s;return l||(i[t.pubxOptimizedKey]=tg(e,t)),i},tm=e=>{var t;let o={},i={enforceJSOn:"f_enf_on",enforceJSOff:"f_enf_off"},r=null===(t=window.__pubx__.abTestConfig)||void 0===t?void 0:t.testBucket,a="A"===r?e.pubxABSplitAKey:e.pubxABSplitBKey,n="A"===r?i.enforceJSOn:i.enforceJSOff;return o[a]=n,o},tO=(e,t)=>{let o={},i=t[e.pubxSplitKey]===e.pubxSplitOnValue,r=e.pubxABSplitAKey;return o[r]=i?"on-v1":"off-v1",o},tR=e=>e.split("__ayManagerEnv__")[0],th=(e,t)=>e.bidder,tv=(e,t)=>{let o=e.bidRequestsCount||0,i=Object.keys(eI);for(let e of i){let t=eI[e];if(o>=t[0]&&o<=t[1])return e}return i[i.length-1]},tE=e=>e>100*Math.random();var tA={};function tN(e){return e[0]+"x"+e[1]}function tI(e){return Array.isArray(e)&&2===e.length&&!isNaN(e[0])&&!isNaN(e[1])}tA=function(e,t,o,i,r){for(t=t.split?t.split("."):t,i=0;i<t.length;i++)e=e?e[t[i]]:r;return e===r?o:e};let tw=(e,t)=>e.getAdUnitPath()===t||e.getSlotElementId()===t;function ty(e){let t;if(window.googletag&&"function"==typeof window.googletag.pubads&&"function"==typeof window.googletag.pubads().getSlots){let o=window.googletag.pubads().getSlots();t=o.find(t=>tw(t,e))}return t}function tT(e){var t;let o=null===(t=window.__pubx__)||void 0===t?void 0:t.logger;try{let t=ty(e);if(t)return{gptSlot:t.getAdUnitPath(),divId:t.getSlotElementId()};return{}}catch(e){return null==o||o.error("getGptSlotInfoForAdUnitCode error:",e),null==o||o.remotePageError({code:en.UNCAUGHT_ERROR,payload:{name:e.name,message:e.message}}),{}}}(eR=es||(es={}))[eR.DESKTOP=0]="DESKTOP",eR[eR.MOBILE=1]="MOBILE",eR[eR.TABLET=2]="TABLET",(eh=el||(el={}))[eh.CHROME=0]="CHROME",eh[eh.FIREFOX=1]="FIREFOX",eh[eh.SAFARI=2]="SAFARI",eh[eh.EDGE=3]="EDGE",eh[eh.INTERNET_EXPLORER=4]="INTERNET_EXPLORER",eh[eh.OTHER=5]="OTHER",(ev=eu||(eu={}))[ev.WINDOWS=0]="WINDOWS",ev[ev.MAC=1]="MAC",ev[ev.LINUX=2]="LINUX",ev[ev.UNIX=3]="UNIX",ev[ev.IOS=4]="IOS",ev[ev.ANDROID=5]="ANDROID",ev[ev.OTHER=6]="OTHER";let tx=()=>{try{if(/ipad|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase()))return es.TABLET;if(/iphone|ipod|android|blackberry|opera|mini|windows\sce|palm|smartphone|iemobile/i.test(navigator.userAgent.toLowerCase()))return es.MOBILE;return es.DESKTOP}catch(e){return es.DESKTOP}},tC=()=>{try{if(/Edg/.test(navigator.userAgent))return el.EDGE;if(/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))return el.CHROME;if(navigator.userAgent.match("CriOS"))return el.CHROME;if(/Firefox/.test(navigator.userAgent))return el.FIREFOX;else if(/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor))return el.SAFARI;else if(/Trident/.test(navigator.userAgent)||/MSIE/.test(navigator.userAgent))return el.INTERNET_EXPLORER;else return el.OTHER}catch(e){return el.OTHER}},tU=()=>{try{if(-1!=navigator.userAgent.indexOf("Android"))return eu.ANDROID;if(-1!=navigator.userAgent.indexOf("like Mac"))return eu.IOS;if(-1!=navigator.userAgent.indexOf("Win"))return eu.WINDOWS;if(-1!=navigator.userAgent.indexOf("Mac"))return eu.MAC;if(-1!=navigator.userAgent.indexOf("Linux"))return eu.LINUX;if(-1!=navigator.appVersion.indexOf("X11"))return eu.UNIX;return eu.OTHER}catch(e){return eu.OTHER}};class tS{static getMetrics(e,t){return{bidderRT:this.getBidderRT(e,t),requestBidsRT:this.getRequestBidsRT(e)}}static getRequestBidsRT(e){let t={priceFloors:0,total:0};return["priceFloors","total"].forEach(o=>{let i=`requestBids.${o}`;void 0!==e[i]&&(t[o]=e[i])}),t}static getBidderRT(e,t){let o={};return t.forEach(t=>{let i=`adapters.client.${t}.total`;void 0!==e[i]?o[t]=Array.isArray(e[i])&&e[i][0]||0:o[t]=0}),o}}(eE=ec||(ec={})).BID_TIMEOUT="bidTimeout",eE.BID_RESPONSE="bidResponse",eE.BID_REJECTED="bidRejected",eE.AUCTION_END="auctionEnd",eE.BID_WON="bidWon",eE.AUCTION_INIT="auctionInit";let tD=[ec.BID_TIMEOUT,ec.BID_RESPONSE,ec.BID_REJECTED,ec.AUCTION_END,ec.BID_WON,ec.AUCTION_INIT];class tF{constructor(e,t,o){var i;this.auctionCache={},this.auctionRankCounter=0,this.auctionIdMap=new Map,this.auctionRankMap=new Map,this.pbxAuctionIdMap=new Map,window.__pubx__=window.__pubx__||{},window.__pubx__.analytics={auctionCache:this.auctionCache,auctionIdMap:this.auctionIdMap},this.initOptions=Object.assign({samplingRate:1},e),this.config=o,this.prebidInstance=t,this.logger=null===(i=window.__pubx__)||void 0===i?void 0:i.logger}getWindowLocation(){var e;try{return(null===(e=window.top)||void 0===e?void 0:e.location)||window.location}catch(e){return this.logger.error("PubxAnalytics getWindowLocation error:",e),this.logger.remotePageError({code:en.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}}),window.location}}getPageDetails(){var e;try{let t=(null===(e=window.arTopContextProps)||void 0===e?void 0:e.page)||this.getWindowLocation().href;if(!t)throw Error("Missing pageUrl");let o=new URL(t);return{host:o.host,path:o.pathname,search:o.search}}catch(e){return this.logger.error("PubxAnalytics getPageDetails error:",e),{host:"",path:"",search:""}}}getAdServerDataForBid(e){try{let t=(null==e?void 0:e.adUnitCode)||"",o=ty(t);if(o)return Object.fromEntries(o.getTargetingKeys().filter(e=>e.startsWith("pubx-")||e.startsWith("hb_")&&1===(e.match(/_/g)||[]).length).map(e=>[e,o.getTargeting(e)]));return{}}catch(e){return this.logger.error("PubxAnalytics getAdServerDataForBid error:",e),this.logger.remotePageError({code:en.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}}),{}}}extractBid(e){var t;return{auctionId:this.getAuctionId(e.auctionId),adUnitCode:e.adUnitCode,gptSlotCode:tT(e.adUnitCode).gptSlot||null,bidderCode:e.bidder,cpm:e.cpm,originalCpm:e.originalCpm,originalCurrency:e.originalCurrency,creativeId:e.creativeId,dealId:e.dealId,currency:e.currency,floorData:e.floorData,mediaType:e.mediaType,netRevenue:e.netRevenue,requestTimestamp:e.requestTimestamp,responseTimestamp:e.responseTimestamp,status:e.status,sizes:(function(e){var t;let o=null===(t=window.__pubx__)||void 0===t?void 0:t.logger;try{return("string"==typeof e?e.split(/\s*,\s*/).map(e=>e.match(/^(\d+)x(\d+)$/i)).filter(e=>null!==e).map(([e,t,o])=>[parseInt(t,10),parseInt(o,10)]):Array.isArray(e)?tI(e)?e.filter(tI):[e]:[]).map(tN)}catch(e){return null==o||o.error("parseSizesInput error:",e),null==o||o.remotePageError({code:en.UNCAUGHT_ERROR,payload:{name:e.name,message:e.message}}),[]}})(e.size).toString(),statusMessage:e.statusMessage,timeToRespond:e.timeToRespond,transactionId:e.transactionId,bidId:e.bidId||e.requestId,placementId:e.params?((t=tA)&&t.__esModule?t.default:t)(e,"params.0.placementId"):null,source:e.source||"null"}}getAuctionId(e){try{if(!e)throw Error(`Missing auctionId(${e})provided to PubxAnalytics in bidResponse`);let t=M(this.config.pubxExperiments);if(e&&"string"==typeof e&&eG(e)&&!t)return e;if(t&&this.pbxAuctionIdMap.has(e)){let t=this.pbxAuctionIdMap.get(e);return this.logger.debug("Using generated auctionId",{originalId:e,generatedId:t}),t}if(e&&this.auctionIdMap.has(e))return this.auctionIdMap.get(e);let o=eB();return this.auctionIdMap.set(e,o),this.logger.debug("Generated new auctionId for invalid auctionId",{originalId:e,generatedId:o}),o}catch(t){if(this.logger.error("PubxAnalytics getAuctionId error:",t),this.logger.remotePageError({code:en.PUBX_ANALYTICS_ERROR,payload:{name:t.name,message:t.message}}),!e)return eB();return e}}track(e,t){try{switch(e){case ec.BID_TIMEOUT:t.map(this.extractBid.bind(this)).forEach(e=>{e.bidType=3,this.addBidToCache(e)});break;case ec.BID_RESPONSE:let o=Object.assign(this.extractBid(t),{bidType:2});this.addBidToCache(o);break;case ec.BID_REJECTED:let i=Object.assign(this.extractBid(t),{bidType:1});this.addBidToCache(i);break;case ec.AUCTION_END:this.processAuctionEnd(t);break;case ec.BID_WON:this.processBidWon(t);break;case ec.AUCTION_INIT:this.processAuctionInit(t)}}catch(e){this.logger.error("PubxAnalytics track error:",e),this.logger.remotePageError({code:en.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}})}}getConsentMetadata(){var e,t;try{return(null===(t=(e=this.prebidInstance).getConsentMetadata)||void 0===t?void 0:t.call(e))||{}}catch(e){return this.logger.error("PubxAnalytics getConsentMetadata error:",e),this.logger.remotePageError({code:en.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}}),{}}}getUserIds(){var e,t;try{return(null===(t=(e=this.prebidInstance).getUserIds)||void 0===t?void 0:t.call(e))||{}}catch(e){return this.logger.error("PubxAnalytics getUserIds error:",e),this.logger.remotePageError({code:en.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}}),{}}}addBidToCache(e){this.auctionCache[e.auctionId]||this.initializeAuctionCache(e.auctionId),this.auctionCache[e.auctionId].bids.push(e)}initializeAuctionCache(e){var t;let o=++this.auctionRankCounter;this.auctionRankMap.set(o,e),this.auctionCache[e]={bids:[],winningBids:[],auctionDetail:{auctionRank:o,auctionId:e,previousAuctionId:this.auctionRankMap.get(o-1)||null},floorDetail:{},adUnitDetails:[],pageDetail:this.getPageDetails(),deviceDetail:{platform:navigator.platform,deviceType:tx(),deviceOS:tU(),browser:tC()},userDetail:{userIdTypes:Object.keys(this.getUserIds())},consentDetail:{consentTypes:Object.keys(this.getConsentMetadata())},pmacDetail:{pmac_data:[]},extraData:(null===(t=window.__pubx__)||void 0===t?void 0:t.extraData)||{},initOptions:Object.assign(Object.assign({},this.initOptions),{auctionId:e}),sendAs:[],performanceMetrics:{}}}collectAuctionAdunitData(e){try{let t=this.getAuctionId(e.auctionId),o=e.bidderRequests,i=e.adUnits,r=new Map;for(let e of i){let t=e.code,o=Object.entries(e.mediaTypes||{}).reduce((e,[t,o])=>("video"===t&&(null==o?void 0:o.context)?e.push(`video:${o.context}`):e.push(t),e),[]);r.set(t,{adunitCode:t,gptSlotCode:tT(t).gptSlot||null,mediaTypes:o,bidders:[],refreshRank:void 0})}for(let e of o)for(let t of e.bids){if(!t.adUnitCode){this.logger.error("PubxAnalytics collectAuctionAdunitData error: Missing adUnitCode in bidderRequest",{bidderRequest:e});continue}let o=r.get(t.adUnitCode);o&&(o.bidders.push(t.bidder),o.refreshRank=t.auctionsCount||t.bidRequestsCount),r.set(t.adUnitCode,o)}this.auctionCache[t].adUnitDetails=Array.from(r.values())}catch(e){this.logger.error("PubxAnalytics collectAuctionAdunitData error:",e),this.logger.remotePageError({code:en.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}})}}collectAndStoreAuctionFeedbackData(e,t){try{let o=this.getAuctionId(e.auctionId),i=this.logger.makeRemoteAucError(e),r=this.logger.makeRemoteAucEvent(e),a={remoteAucError:i,remoteAucEvent:r},n=[];e.adUnits.forEach(i=>{let r=R(i,e,t,a),{adUnitStatus:d,originalBidCpmValue:s,bidCurrency:l,adserverTargeting:u,floorData:c,floorProvider:_,floorSkipStatus:p,floorModelVersion:g}=r,f={auctionId:o,auctionRank:this.auctionRankCounter,adUnitCode:i.code,status:d,bidCurrency:l,bidValue:s,pubCurrency:t.currency,adserverTargeting:u,floorData:m(c),floorProvider:_,floorSkipStatus:p,floorModelVersion:g};n.push(f)}),Object.assign(this.auctionCache[o].pmacDetail,{pmac_data:n})}catch(r){this.logger.error("PubxAnalytics collectAndStoreAuctionFeedbackData error:",r),this.logger.remotePageError({code:en.PUBX_ANALYTICS_ERROR,payload:{name:r.name,message:r.message}});let o=this.getAuctionId(e.auctionId),i=e.adUnits.map(e=>({auctionId:o,auctionRank:this.auctionRankCounter,adUnitCode:e.code,pubCurrency:t.currency}));Object.assign(this.auctionCache[o].pmacDetail,{pmac_data:i})}}processAuctionEnd(e){var t,o;try{let i=this.getAuctionId(e.auctionId);this.auctionCache[i]||this.initializeAuctionCache(i),Object.assign(this.auctionCache[i].floorDetail,(null===(t=e.adUnits)||void 0===t?void 0:t.map(e=>{var t,o;return(null===(t=null==e?void 0:e.bids)||void 0===t?void 0:t.length)&&(null===(o=e.bids[0])||void 0===o?void 0:o.floorData)}).find(e=>e))||{}),this.auctionCache[i].deviceDetail.cdep=e.bidderRequests.map(e=>{var t,o,i;return null===(i=null===(o=null===(t=e.ortb2)||void 0===t?void 0:t.device)||void 0===o?void 0:o.ext)||void 0===i?void 0:i.cdep}).find(e=>e),Object.assign(this.auctionCache[i].auctionDetail,{adUnitCodes:(null===(o=e.adUnits)||void 0===o?void 0:o.map(e=>e.code))||[],timestamp:e.timestamp}),e.metrics&&e.metrics.getMetrics&&"function"==typeof e.metrics.getMetrics&&(this.auctionCache[i].performanceMetrics=function(e){var t,o;try{let i=(null===(t=e.metrics)||void 0===t?void 0:t.getMetrics())||{},r=(null===(o=e.bidderRequests)||void 0===o?void 0:o.map(e=>e.bidderCode))||[];return tS.getMetrics(i,r)}catch(e){return console.error("Error creating performance metrics:",e),tS.getMetrics({},[])}}(e)),this.collectAndStoreAuctionFeedbackData(e,this.config),this.collectAuctionAdunitData(e),this.prepareAuctionSend(i)}catch(e){this.logger.error("PubxAnalytics processAuctionEnd error:",e),this.logger.remotePageError({code:en.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}})}}processBidWon(e){try{let t=this.extractBid(e);this.auctionCache[t.auctionId]||this.initializeAuctionCache(t.auctionId);let o=this.auctionCache[t.auctionId].floorDetail;Object.assign(t,{floorProvider:(null==o?void 0:o.floorProvider)||null,floorFetchStatus:(null==o?void 0:o.fetchStatus)||null,floorLocation:(null==o?void 0:o.location)||null,floorModelVersion:(null==o?void 0:o.modelVersion)||null,floorSkipRate:(null==o?void 0:o.skipRate)||0,isFloorSkipped:(null==o?void 0:o.skipped)||!1,isWinningBid:!0,renderedSize:e.size,bidType:4,adServerData:this.getAdServerDataForBid(t)}),this.auctionCache[t.auctionId].winningBids.push(t),this.prepareSendWinningBids(t)}catch(e){this.logger.error("PubxAnalytics processBidWon error:",e),this.logger.remotePageError({code:en.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}})}}processAuctionInit(e){if(!M(this.config.pubxExperiments))return;let t=eB();this.pbxAuctionIdMap.set(e.auctionId,t)}shouldFireEventRequest(e=""){var t;try{let o=null!==(t=this.initOptions.samplingRate)&&void 0!==t?t:1;return parseInt(function(e,t=0){let o=function(e,t){if("function"==typeof Math.imul)return Math.imul(e,t);var o=(4194303&e)*(t|=0);return 4290772992&e&&(o+=(4290772992&e)*t|0),0|o},i=3735928559^t,r=1103547991^t;for(let t=0,a;t<e.length;t++)i=o(i^(a=e.charCodeAt(t)),2654435761),r=o(r^a,1597334677);return i=o(i^i>>>16,2246822507)^o(r^r>>>13,3266489909),(4294967296*(2097151&(r=o(r^r>>>16,2246822507)^o(i^i>>>13,3266489909)))+(i>>>0)).toString()}(e))%o==0}catch(e){return this.logger.error("PubxAnalytics shouldFireEventRequest error:",e),this.logger.remotePageError({code:en.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}}),!1}}prepareSendWinningBids(e){try{let{auctionId:t}=e;if(!this.shouldFireEventRequest(t))return;let o=Object.assign({},this.auctionCache[t]);o.winningBid=e;let i={path:tF.winningBidPath,requiredKeys:["winningBid","pageDetail","deviceDetail","floorDetail","auctionDetail","userDetail","consentDetail","pmacDetail","extraData","initOptions","performanceMetrics"],eventType:"win"};this.sendData(i,o)}catch(e){this.logger.error("PubxAnalytics prepareSendWinningBids error:",e),this.logger.remotePageError({code:en.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}})}}prepareAuctionSend(e){try{if(!this.shouldFireEventRequest(e))return;let t=Object.assign({},this.auctionCache[e]),o={path:tF.auctionPath,requiredKeys:["bids","pageDetail","deviceDetail","floorDetail","auctionDetail","userDetail","adUnitDetails","consentDetail","pmacDetail","extraData","initOptions","performanceMetrics"],eventType:"auction"};if(this.auctionCache[e].sendAs.includes(o.eventType))return;this.sendData(o,t),this.auctionCache[e].sendAs.push(o.eventType)}catch(e){this.logger.error("PubxAnalytics prepareAuctionSend error:",e),this.logger.remotePageError({code:en.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}})}}sendData(e,t){try{var o,i;if(!e.requiredKeys.every(e=>!!t[e]))return;let r=((o={protocol:"https",hostname:this.initOptions.hostName||tF.defaultHost,pathname:e.path,search:{auctionTimestamp:t.auctionDetail.timestamp,pubxaiAnalyticsVersion:"v2.3.0",prebidVersion:this.prebidInstance.version.split("v")[1],pubxId:this.initOptions.pubxId}}).protocol||"http")+"://"+(o.host||o.hostname+(o.port?`:${o.port}`:""))+(o.pathname||"")+(o.search?`?${i=o.search||{},Object.keys(i).map(e=>Array.isArray(i[e])?i[e].map(t=>`${e}[]=${t}`).join("&"):`${e}=${i[e]}`).join("&")}`:"")+(o.hash?`#${o.hash}`:""),a=Object.fromEntries(e.requiredKeys.map(e=>[e,t[e]])),n=JSON.stringify([a]);fetch(r,{method:"POST",body:n,headers:{"Content-Type":"text/plain"}})}catch(e){this.logger.error("PubxAnalytics sendData error:",e),this.logger.remotePageError({code:en.PUBX_ANALYTICS_ERROR,payload:{name:e.name,message:e.message}})}}setupPrebidListeners(){this.prebidInstance.onEvent("auctionEnd",e=>{this.track(ec.AUCTION_END,e)}),this.prebidInstance.onEvent("bidResponse",e=>{this.track(ec.BID_RESPONSE,e)}),this.prebidInstance.onEvent("bidRejected",e=>{this.track(ec.BID_REJECTED,e)}),this.prebidInstance.onEvent("bidTimeout",e=>{this.track(ec.BID_TIMEOUT,e)}),this.prebidInstance.onEvent("bidWon",e=>{this.track(ec.BID_WON,e)}),this.prebidInstance.onEvent("auctionInit",e=>{this.track(ec.AUCTION_INIT,e)})}logMissedEvents(){let e=this.prebidInstance.getEvents().filter(e=>tD.includes(e.eventType));e.forEach(e=>{this.track(e.eventType,e.args)})}initialise(){this.logMissedEvents(),this.setupPrebidListeners()}}tF.defaultHost="api.pbxai.com",tF.auctionPath="/analytics/auction",tF.winningBidPath="/analytics/bidwon",i().pbNsKeys.split(",").map(e=>W(e)).forEach(e=>{ta(e,"PB_GAM_STATIC"),function(e,t=!1){e.pbNamespace.que.push(()=>{var o;let i=null===(o=window.__pubx__)||void 0===o?void 0:o.logger;try{let o=e.pbNamespace,r=e.pbNamespace.version.replace("v","");if(t){null==i||i.debug("Prebid Analytics is enabled for Prebid version: ",r),n(e);return}null==i||i.debug("Pubx Analytics is enabled for Prebid version: ",r);let a={pubxId:e.pubxId,samplingRate:e.samplingRate},d=new tF(a,o,e);d.initialise()}catch(e){null==i||i.error("Error enabling analytics: ",e)}})}(e),G(e),B(e,s),S(e),J(e,z),Z(e)})})();